<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.shop.mapper.UserMapper">
	
	<select id="getLogin" parameterType="user" resultType="user">
		SELECT
			  `uid`,
			  `username`,
			  `password`,
			  `iphone`,
			  `email`,
			  `code`,
			  `state`,
			  `type`
			FROM `user`
		where username = "${username}" and password = "${password}"
	</select>
	
	<insert id="saveUser" parameterType="user">
		<selectKey keyProperty="uid" resultType="string" order="BEFORE">
			SELECT UUID()
		</selectKey>
		INSERT INTO `user` 
			(`uid`, 
			`username`, 
			`password`, 
			`age`, 
			`sex`, 
			`iphone`, 
			`email`, 
			`code`, 
			`state`, 
			`type`
			)
			VALUES
			(#{uid}, 
			#{username}, 
			#{password}, 
			#{age}, 
			#{sex}, 
			#{iphone}, 
			#{email}, 
			#{code}, 
			#{state}, 
			#{type}
			);
				
	</insert>
	
	<update id="saveActive" parameterType="string">
		UPDATE `user` 
			SET
			`state` = "1",
			`code` = null
			WHERE
			`code` = #{state};
		
	</update>
</mapper>
